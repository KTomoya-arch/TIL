## Protected サブネットにインターネット公開する EC2 を作ってはなぜダメなのか？

パブリックはインターネットへ公開できる。

### パブリックとプロテクティッドの違いは？

パブリックは vpc 内からも外からも通信可能にする、プロテクトは vpc 内から外へは ok だが逆は NG(用途)
この仕組みはどう実現されている？
⇨ デフォルトのルート(宛先の 0.0.0.0/0)をインターネットゲートウェイにしているのか、NAT ゲートウェイにしているかの違い。
デフォルトゲートウェイは通信しに行く際のルーターをさす。

### NAT ゲートウェイはインターネットからは入ってこれないのはなぜ？

NAT ゲートウェイはプライベート IP をパブリック IP に変換する役割を持っている。
送信する際には NAT ゲートウェイに割り当てられた EIP を送信元として送り、戻ってくる際にはその送信元に目掛けて戻ってくる。

### ただし、NAT ゲートウェイを通じて入ってこれる場合と入ってこれない場合がある

外からのリクエストの場合は入ってこれない。NAT ゲートウェイまではくることは可能だがその先がわからないので NAT ゲートウェイで止まる。
しかし、中からリクエストをした場合のレスポンスは送信元(どこに返すか)がわかるため、正常に返却される。リクエストとレスポンスは違う。

### public subnet

パブリックサブネットに置く EC2 は必ず public ip を割り当てなければいけない。(通信できない。)

### TCP と UDP の違いは？

#### TCP はコネクションを確立する

コネクションを確立するぶん、スピードが落ちるが信頼性が担保される
スリーウェイハンドシェイクをし、その後パケットを送るがそのパケットの送り順を理解している。
欠損なく、再送も可能である。

#### UDP はコネクションを確立しない

欠損も気にしないがヘッダーは軽く、高速に通信ができる。
DNS は UDP である

### EC2 のグローバル IP アドレスを EIP で固定した。動的な割り当ても可能ですが固定にこだわる理由は？

EIP を使用する＝固定 IP を使用する。
dns へ問い合わせを行いたいクライアントはキャッシュ dns サーバへ問い合わせ、なければ権威 dns サーバへ問い合わせを行う。
IP アドレス制限をかけるような場合に固定しておくと割と楽

### policy

- aws が用意しているポリシーは aws managed ポリシー
- カスタマー managed ポリシー
- カスタマーインラインポリシー(Role の中に直接ポリシーを記述する。)

### EC2 インスタンスタイプについて詳しく

d がつくとインスタンスストアが付加される。
⇨ インスタンスに内蔵されるストレージで読み書きも高速のストレージ。


